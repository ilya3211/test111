!function(e){"function"==typeof define&&define.amd?define("scripts",e):e()}((function(){"use strict";function e(){return{base64Encode:function(e){var t,i,r,a,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",s=0,l="";do{t=(a=e.charCodeAt(s++)<<16|e.charCodeAt(s++)<<8|e.charCodeAt(s++))>>12&63,i=a>>6&63,r=63&a,l+=n.charAt(a>>18&63)+n.charAt(t)+n.charAt(i)+n.charAt(r)}while(s<e.length);switch(e.length%3){case 1:l=l.slice(0,-2)+"==";break;case 2:l=l.slice(0,-1)+"="}return l},base64Decode:function(e){var t,i,r,a,n,s,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o=0,p="";do{t=(s=l.indexOf(e.charAt(o++))<<18|l.indexOf(e.charAt(o++))<<12|(a=l.indexOf(e.charAt(o++)))<<6|(n=l.indexOf(e.charAt(o++))))>>16&255,i=s>>8&255,r=255&s,p+=64==a?String.fromCharCode(t):64==n?String.fromCharCode(t,i):String.fromCharCode(t,i,r)}while(o<e.length);return p},serialize:function(e){try{return this.base64Encode(encodeURIComponent(JSON.stringify(e)))}catch(e){console.error(e)}return""},unserialize:function(e){try{return JSON.parse(decodeURIComponent(this.base64Decode(e)))}catch(e){console.error(e)}return{}},nl2br:function(e){return"string"==typeof e?e.replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1<br>"):e}}}jQuery((function(e){e(".js-expert-review-poll").on("click",(function(t){t.preventDefault();var i=e(t.currentTarget),r=i.data("id"),a=i.data("action");function n(t,a){a=a||function(){},e.ajax({url:expert_review_globals.url,type:"post",data:{action:"expert_review_update_poll_state",nonce:expert_review_globals.nonce,poll_id:r,act:t},beforeSend:function(){i.attr("disabled",!0)}}).done((function(e){e.success?a(e):console.log(e)})).always((function(){i.attr("disabled",!1)}))}switch(i.blur(),a){case"hide":n("hide",(function(){i.hide(),e('.js-expert-review-poll[data-id="'+r+'"][data-action="display"]').show()}));break;case"display":n("display",(function(){i.hide(),e('.js-expert-review-poll[data-id="'+r+'"][data-action="hide"]').show()}));break;case"pause":n("pause",(function(){i.hide(),e('.js-expert-review-poll[data-id="'+r+'"][data-action="resume"]').show()}));break;case"resume":n("resume",(function(){i.hide(),e('.js-expert-review-poll[data-id="'+r+'"][data-action="pause"]').show()}));break;case"reset":n(a)}}))})),jQuery((function(t){if(expert_review_globals.enabled){var i=expert_review_globals.i18n,r=new e,a=new function(){var e="expert_review_section_state_"+r.base64Encode(window.location.origin),i={},a=!0;"undefined"==typeof localStorage&&(console.warn("Expert Review: Unable to init sections state."),a=!1);return{init:function(){if(a){var r=localStorage.getItem(e);return r&&(i=JSON.parse(r)),t(document).find(".js-mce-expert-review-section").each((function(){var e=t(this),r=e.data("id");i.hasOwnProperty(r)&&(i[r]?e.show():e.hide())})),this}},pushState:function(t,r){if(a)return i[t]=r?1:0,localStorage.setItem(e,JSON.stringify(i)),this}}},n="expert_review",s={color:"purple-1",expert_type:"self",expert_show_button:1,expert_show_button_type:"popup",score_max:5,qa_show_title:1,qa_title:i.qa_title,qa:[],score:[],pluses:[],minuses:[],pluses_minuses_show_title:1,pluses_minuses_title:i.pluses_minuses_title,pluses_title:"",minuses_title:"",expert_question_button_text:i.expert_question_button_text},l=wp.media.template("expert-review-popup");wp.mce=wp.mce||{},wp.mce.expert_review_expert={defaultParams:t.extend({},s),shortcode_data:{},template:wp.media.template("expert-review-live-preview"),getContent:function(){var e=this.shortcode.attrs.named;e.innercontent=this.shortcode.content;var i=Object.assign({},s),r={};return r=void 0===e.params?u(r=t.extend({},i,e)):t.extend({},i,v(e.params)),this.template(r)},edit:function(e){var i=wp.shortcode.next(n,e),r=Object.assign({},s),a={},l=i.content.match(/\[expert_review params="([^\]]*)"\]/);a=null===l?u(a=t.extend({},r,i.shortcode.attrs.named)):t.extend({},r,v(l[1])),wp.mce.expert_review_expert.popupwindow(tinyMCE.activeEditor,a)},popupwindow:function(e,r){var s=t(window).width();e.windowManager.open({title:i.title,html:l(r),width:s>=600?600:void 0,height:t(window).height()-200,buttons:[{text:i.ok,subtype:"primary",onclick:function(){e.insertContent(wp.shortcode.string({tag:n,type:"single",attrs:{params:d(c())}})),tinymce.activeEditor.windowManager.close()}},{text:i.cancel,onclick:"close"}]}),setTimeout((function(){a.init(),t(document).find(".js-mce-expert-review-type").val(r.expert_type).trigger("change"),t(document).find(".js-mce-expert-review-expert-show-button-type select").prop("checked",r.expert_show_button_type).trigger("change"),t(document).find('.js-mce-expert-review-color[data-color="'+r.color+'"]').trigger("click"),t(document).find(".js-mce-expert-review-qa-list").sortable({items:".js-mce-expert-review-qa-item",axis:"y"}),t(document).find(".mce-expert-review-pluses-container").sortable({items:".mce-expert-review-plus",axis:"y"}),t(document).find(".mce-expert-review-minus-container").sortable({items:".mce-expert-review-minus",axis:"y"}),t(document).find(".mce-expert-review-score-lines").sortable({items:".mce-expert-review-score-line",axis:"y"})}),50)}},wp.mce.views.register(n,wp.mce.expert_review_expert),t(document).on("click",".js-mce-expert-review-header",(function(){var e=t(this).next(".js-mce-expert-review-section");e.length&&e.slideToggle(150,(function(){a.pushState(e.data("id"),e.is(":visible"))}))})),t(document).on("change",".js-mce-expert-review-type",(function(){var e=t(this),i=t(".js-mce-expert-review-expert-avatar"),r=t(".js-mce-expert-review-expert-name"),a=t(".js-mce-expert-review-expert-link"),n=t(".js-mce-expert-review-expert-experts"),s=t(".js-mce-expert-review-expert-users");switch(e.val()){case"user_id":i.hide(),r.hide(),a.hide(),n.hide(),s.show();break;case"expert_id":i.hide(),r.hide(),a.hide(),s.hide(),n.show();break;default:i.show(),r.show(),a.show(),n.hide(),s.hide()}})),t(document).on("change",".js-mce-expert-review-expert-show-button-type select",(function(){switch(t(this).val()){case"popup":t(document).find(".js-mce-expert-review-expert-popup-use-phone").show(),t(document).find(".js-mce-expert-review-external-link").hide();break;case"comments":t(document).find(".js-mce-expert-review-expert-popup-use-phone").hide(),t(document).find(".js-mce-expert-review-external-link").hide();break;case"link":t(document).find(".js-mce-expert-review-expert-popup-use-phone").hide(),t(document).find(".js-mce-expert-review-external-link").show()}})),t(document).on("click",".js-mce-expert-review-expert-avatar-alt-additional",(function(){var e=t(this),i=e.parents(".js-mce-expert-review-expert-avatar-alt"),r=i.find("label");e.hide(),r.text(r.data("label")).show(),i.find("input").show()})),t(document).on("click",".js-mce-expert-review-color",(function(){var e=t(this),i=e.data("color"),r=t(".js-mce-expert-review-color-field");if(e.hasClass("active"))return e.removeClass("active"),r.val(""),!1;t(".js-mce-expert-review-color").removeClass("active"),e.addClass("active"),r.val(i)})),t(document).on("click",".js-mce-expert-review-qa-add",(function(){var e=t(this).parent().parent().find(".js-mce-expert-review-qa-list"),i=e.find(".js-mce-expert-review-qa-item").last().clone();return i.find("textarea").val(""),e.append(i),!1})),t(document).on("click",".js-mce-expert-review-qa-remove",(function(){var e=t(this).parents(".js-mce-expert-review-qa-item");e.parent().find(".js-mce-expert-review-qa-item").length>1?e.remove():e.find("textarea").val("")})),t(document).on("click",".js-mce-expert-review-score-line-add",(function(){t(this);var e=t(".js-mce-expert-review-score-lines"),i=e.find(".js-mce-expert-review-score-line:last").clone();return i.find("input").val(""),e.append(i),!1})),t(document).on("click",".js-mce-expert-review-score-line-remove",(function(){var e=t(this).parents(".js-mce-expert-review-score-line");t(".js-mce-expert-review-score-line").length>1?e.remove():e.find("input").val("")})),t(document).on("click",".js-mce-expert-review-plus-minus-add",(function(){var e=t(this).parent().parent().find(".js-mce-expert-review-pluses-minuses-container"),i=e.find(".js-mce-expert-review-plus,.js-mce-expert-review-minus").last().clone();return i.find("input").val(""),e.append(i),!1}));var o=null,p=null;t(document).on("change",".js-mce-expert-review-expert-preset-list select",(function(){var e=t(this),i=t(".js-mce-expert-review-expert-preset-save button");null===o&&(o=i.text(),p=i.data("update_text")),t(".js-mce-expert-review-preset-name input").val(e.val()),i.text(e.val()?p:o)})),t(document).on("click",".js-mce-expert-review-expert-preset-select button",(function(e){e.preventDefault();var r=t(this),a=t(".js-mce-expert-review-expert-preset-list select"),l=a.val();l?"remove"===r.val()?t.ajax({url:expert_review_globals.url,type:"post",data:{action:"expert_review_preset_remove",nonce:expert_review_globals.nonce,name:l},beforeSend:function(){r.prop("disabled",!0)}}).done((function(e){e.success?(a.find('option[value="'+l+'"]').remove(),__expert_review_preset_items=__expert_review_preset_items.filter((function(e){return e!==l})),a.trigger("change")):console.log(e)})).always((function(){r.prop("disabled",!1)})):t.ajax({url:expert_review_globals.url,type:"post",data:{action:"expert_review_preset_get",nonce:expert_review_globals.nonce,name:l},beforeSend:function(){r.prop("disabled",!0)}}).done((function(e){e.success?(tinymce.activeEditor.windowManager.close(),"close"===r.val()?tinymce.activeEditor.insertContent(wp.shortcode.string({tag:n,type:"single",attrs:{params:d(t.extend({},s,c(),e.data.data))}})):wp.mce.expert_review_expert.popupwindow(tinymce.activeEditor,t.extend({},s,e.data.data))):console.log(e)})).always((function(){r.prop("disabled",!1)})):alert(i.select_preset)})),t(document).on("click",".js-mce-expert-review-expert-preset-save button",(function(e){e.preventDefault();var r=t(this),a=t(".js-mce-expert-review-preset-name input").val(),n=t(".js-mce-expert-review-expert-preset-list select");if(a){var s=c(),l=!1;n.find("option").each((function(){var e=t(this);e.val()&&a===e.val()&&(l=!0)})),l&&!confirm(i.want_override+' "'+a+'"?')||t.ajax({url:expert_review_globals.url,type:"post",data:{action:"expert_review_preset_save",nonce:expert_review_globals.nonce,name:a,data:s},beforeSend:function(){r.prop("disabled",!0)}}).done((function(e){e.success?(l||n.append(t("<option></option>").attr("value",a).text(a)),n.find('option[value="'+a+'"]').attr("selected",!0),__expert_review_preset_items.push(a),n.trigger("change")):console.log(e)})).always((function(){r.prop("disabled",!1)}))}else alert(i.enter_name)})),t(document).on("click",".js-mce-expert-review-plus-minus-remove",(function(){var e=t(this).parents(".js-mce-expert-review-plus,.js-mce-expert-review-minus");e.parent().find(".js-mce-expert-review-plus,.js-mce-expert-review-minus").length>1?e.remove():e.find("input").val("")}))}function c(){var e={},i=function(e){var i=t(document).find(e);return i.is(":checkbox")?i.prop("checked")?1:0:i.val()},r=i(".js-mce-expert-review-color-field");r&&(e.color=r),e.expert_avatar="",e.expert_name="",e.expert_link="",e.expert_id="";var a=i(".js-mce-expert-review-expert-type select");switch(e.expert_type=a,a){case"self":e.expert_avatar=i(".js-mce-expert-review-expert-avatar input"),e.expert_name=i(".js-mce-expert-review-expert-name input"),e.expert_link=i(".js-mce-expert-review-expert-link input");break;case"user_id":e.expert_id=i(".js-mce-expert-review-expert-users select");break;case"expert_id":e.expert_id=i(".js-mce-expert-review-expert-experts select")}return e.expert_avatar_alt=i(".js-mce-expert-review-expert-avatar-alt input"),e.expert_show=i(".js-mce-expert-review-expert-show-expert input"),e.expert_description=i(".js-mce-expert-review-expert-description input"),e.expert_show_button=i(".js-mce-expert-review-expert-show-button input"),e.expert_show_button_type=i(".js-mce-expert-review-expert-show-button-type select"),e.expert_question_button_text=i(".js-mce-expert-review-expert-question-button-text input"),e.question_external_link=i(".js-mce-expert-review-external-link input"),e.popup_use_phone=i(".js-mce-expert-review-expert-popup-use-phone input"),e.expert_title=i(".js-mce-expert-review-expert-title input"),e.expert_show_title=i(".js-mce-expert-review-expert-show-title input"),e.expert_text=i(".js-mce-expert-review-expert-text textarea"),e.qa=[],t(document).find(".js-mce-expert-review-qa-item").each((function(){var i=t(this),r=i.find("textarea:first").val(),a=i.find("textarea:last").val();(r||a)&&e.qa.push({q:r,a:a})})),e.qa_show_title=i(".js-mce-expert-review-qa-show-title input"),e.qa_title=i(".js-mce-expert-review-qa-title input"),e.score=[],t(document).find(".js-mce-expert-review-score-line").each((function(){var i=t(this),r=i.find(".js-mce-expert-review-score-line-name input").val(),a=i.find(".js-mce-expert-review-score-line-score input").val();(r||a)&&e.score.push({n:r,s:a})})),e.score_summary_text=i(".js-mce-expert-review-summary-text textarea"),e.score_summary_average=i(".js-mce-expert-review-summary-average input"),e.score_max=i(".js-mce-expert-review-score-max input"),e.score_symbol=i(".js-mce-expert-review-score-symbol input"),e.score_title=i(".js-mce-expert-review-score-title input"),e.score_show_title=i(".js-mce-expert-review-score-show-title input"),e.pluses=[],e.minuses=[],t(document).find(".js-mce-expert-review-plus input").each((function(){var i=t(this).val();i&&e.pluses.push(i)})),t(document).find(".js-mce-expert-review-minus input").each((function(){var i=t(this).val();i&&e.minuses.push(i)})),e.pluses_minuses_show_title=i(".js-mce-expert-review-plus-minus-show-title input"),e.pluses_minuses_title=i(".js-mce-expert-review-plus-minus-title input"),e.pluses_title=i(".js-mce-expert-review-pluses-title input"),e.minuses_title=i(".js-mce-expert-review-minuses-title input"),console.log(e),e}function u(e){["expert_description","expert_title","pluses_minuses_title","qa_title","pluses","minuses","score_data"].forEach((function(t){e.hasOwnProperty(t)&&(e[t]=x(e[t],!1))}));if(["expert_text","score_summary_text","qa_data"].forEach((function(t){e.hasOwnProperty(t)&&(e[t]=x(e[t],!0))})),e.hasOwnProperty("qa_data")&&(e.qa=[],e.qa_data.split(";;").forEach((function(t){var i=t.split("::");e.qa.push({q:i[0],a:i[1]})}))),delete e.qa_data,e.hasOwnProperty("score_data")&&(e.score=[],e.score_data.split(";;").forEach((function(t){var i=t.split("::");e.score.push({n:i[0],s:i[1]})}))),delete e.score_data,e.hasOwnProperty("pluses")&&"string"==typeof e.pluses){var t=e.pluses;e.pluses=[],t.split(";;").forEach((function(t){t&&e.pluses.push(t)}))}if(e.hasOwnProperty("minuses")&&"string"==typeof e.minuses){var i=e.minuses;e.minuses=[],i.split(";;").forEach((function(t){t&&e.minuses.push(t)}))}return e}function d(e){return r.serialize(e)}function v(e){return r.unserialize(e)}function x(e,t){return"string"!=typeof e?e:m(t?function(e){return e.replace(new RegExp("<br>","g"),"\n")}(e):e)}function m(e){return e.replace(/&amp;/g,"&").replace(new RegExp("&quot;","g"),'"').replace(new RegExp("&#039;","g"),"'")}})),jQuery((function(t){if(expert_review_globals.enabled){var i=expert_review_globals.i18n,r=new e,a="expert_review_faq",n={title:i.faq_title_default,show_title:!1,expanded:!1,style:"simple-1",color:"blue-1",qa:[]};t(document).on("click",".js-mce-expert-review-faq-qa-add",(function(){var e=t(this).parent().parent().find(".js-mce-expert-review-faq-qa-list"),i=e.find(".js-mce-expert-review-faq-qa-item").last().clone();return i.find("textarea").val(""),e.append(i),!1})),t(document).on("click",".js-mce-expert-review-faq-qa-remove",(function(){var e=t(this).parents(".js-mce-expert-review-faq-qa-item");e.parent().find(".js-mce-expert-review-faq-qa-item").length>1?e.remove():e.find("textarea").val("")})),wp.mce=wp.mce||{};var s=wp.media.template("expert-review-faq-popup");wp.mce.expert_review_faq={shortcode_data:{},template:wp.media.template("expert-review-faq-live-preview"),getContent:function(){var e=this.shortcode.attrs.named;return this.template(r.unserialize(e.params))},edit:function(e){var t=wp.shortcode.next(a,e).shortcode.attrs.named;wp.mce.expert_review_faq.popupwindow(tinyMCE.activeEditor,r.unserialize(t.params))},popupwindow:function(e,o){o=t.extend({},n,o),e.windowManager.open({title:i.faq_title,html:s(o),width:600,height:t(window).height()-200,buttons:[{text:i.ok,subtype:"primary",onclick:function(){e.insertContent(wp.shortcode.string({tag:a,type:"single",attrs:{params:r.serialize(l())}})),tinymce.activeEditor.windowManager.close()}},{text:i.cancel,onclick:"close"}]}),setTimeout((function(){t(document).find('.js-mce-expert-review-color[data-color="'+o.color+'"]').trigger("click"),t(document).find(".mce-expert-review-qa-list").sortable({items:".mce-expert-review-qa-item",axis:"y"})}),50)}},wp.mce.views.register(a,wp.mce.expert_review_faq)}function l(){var e=function(e){var i=t(document).find(e);return i.is(":checkbox")?i.prop("checked")?1:0:i.val()},i={qa:[]};return i.show_title=e(".js-mce-expert-review-faq-show-title input"),i.expanded=e(".js-mce-expert-review-faq-expanded input"),i.title=e(".js-mce-expert-review-faq-title input"),i.style=e(".js-mce-expert-review-faq-style select"),i.color=e(".js-mce-expert-review-color-field"),t(document).find(".js-mce-expert-review-faq-qa-item").each((function(){var e=t(this),r=e.find("textarea:first").val(),a=e.find("textarea:last").val();(r||a)&&i.qa.push({q:r,a:a})})),i}})),jQuery((function(e){if(expert_review_globals.enabled){e(document).on("click",".js-expert-review-likes-live-preview button",(function(t){t.preventDefault(),e(this).toggleClass("voted")}));var t=expert_review_globals.i18n,i=wp.media,r="expert_review_likes";wp.mce=wp.mce||{},wp.mce.expert_review_likes={shortcode_data:{},template:i.template("expert-review-likes-live-preview"),getContent:function(){var e=this.shortcode.attrs.named;return e.innercontent=this.shortcode.content,this.template(e)},edit:function(e){var t=wp.shortcode.next(r,e),i=t.shortcode.attrs.named;i.innercontent=t.shortcode.content;var a=i.hasOwnProperty("entity_type")?i.entity_type:"posts";wp.mce.expert_review_likes.popupwindow(tinyMCE.activeEditor,i,a)},popupwindow:function(i,s,l){l=l||"posts",s=e.extend({},a(l),s);["show_icon","show_label","show_count","hide_dislikes"].forEach((function(e){s.hasOwnProperty(e)&&"boolean"!=typeof s[e]&&(s[e]=!!parseInt(s[e]))})),i.windowManager.open({title:t.likes_popup_title,body:n(l,s),onsubmit:function(t){var n=e.extend({},a(l),{style:t.data.style,size:t.data.size,icons:t.data.icons,alignment:t.data.alignment,show_icon:t.data.show_icon?1:0,show_label:t.data.show_label?1:0,show_count:t.data.show_count?1:0,hide_dislikes:t.data.hide_dislikes?1:0,label_like:t.data.label_like,label_dislike:t.data.label_dislike});["name","link","post_id"].forEach((function(e){t.data[e]&&(n[e]=t.data[e])})),"posts"!==l&&(n.entity_type=l);var s={tag:r,type:"single",attrs:n};i.insertContent(wp.shortcode.string(s))}})}},wp.mce.views.register(r,wp.mce.expert_review_likes)}function a(e){switch(e){case"posts":return{style:"button-1-color",size:"m",icons:"thumbs",alignment:"",show_icon:!0,show_label:!0,show_count:!0,hide_dislikes:!1,label_like:t.likes_default_value_like,label_dislike:t.likes_default_value_dislike,name:"",link:"",post_id:""};case"comments":return{style:"button-3-color",size:"s",icons:"thumbs",alignment:"left",show_icon:!0,show_label:!1,show_count:!0,hide_dislikes:!1,label_like:t.likes_default_value_like,label_dislike:t.likes_default_value_dislike}}return{}}function n(e,i){switch(e){case"posts":return[{type:"listbox",name:"style",label:t.likes_label_style,values:[{text:"Simple 1",value:"simple-1"},{text:"Button 1",value:"button-1"},{text:"Button 1 Colored",value:"button-1-color"},{text:"Button 2",value:"button-2"},{text:"Button 2 Colored",value:"button-2-color"},{text:"Button 3",value:"button-3"},{text:"Button 3 Colored",value:"button-3-color"},{text:"Button 4",value:"button-4"},{text:"Button 5",value:"button-5"},{text:"Color 1",value:"color-1"},{text:"Color 2",value:"color-2"},{text:"Vertical 1",value:"vertical-1"}],value:i.style},{type:"listbox",name:"size",label:t.likes_label_size,values:[{text:"XS",value:"xs"},{text:"S",value:"s"},{text:"M",value:"m"},{text:"L",value:"l"},{text:"XL",value:"xl"},{text:"XXL",value:"xxl"}],value:i.size},{type:"listbox",name:"icons",label:t.likes_label_icons,values:[{text:"thumbs",value:"thumbs"},{text:"chevron",value:"chevron"},{text:"chevron-bold",value:"chevron-bold"},{text:"plusminus",value:"plusminus"},{text:"plusminus-circle",value:"plusminus-circle"},{text:"arrow-1",value:"arrow-1"},{text:"arrow-2",value:"arrow-2"},{text:"arrow-3",value:"arrow-3"},{text:"heart",value:"heart"},{text:"smile",value:"smile"}],value:i.icons},{type:"listbox",name:"alignment",label:t.likes_label_alignment,values:[{text:"",value:""},{text:"left",value:"left"},{text:"center",value:"center"},{text:"right",value:"right"}],value:i.alignment},{type:"checkbox",name:"show_icon",label:t.likes_label_show_icon,text:t.likes_text_show,checked:i.show_icon},{type:"checkbox",name:"show_label",label:t.likes_label_show_label,text:t.likes_text_show,checked:i.show_label},{type:"checkbox",name:"show_count",label:t.likes_label_show_count,text:t.likes_text_show,checked:i.show_count},{type:"checkbox",name:"hide_dislikes",label:t.likes_label_hide_dislikes,text:t.likes_text_hide,checked:i.hide_dislikes},{type:"textbox",name:"label_like",label:t.likes_label_like,value:i.label_like},{type:"textbox",name:"label_dislike",label:t.likes_label_dislike,value:i.label_dislike},{type:"container",html:"&nbsp;"},{type:"textbox",name:"name",label:t.likes_label_name,tooltip:t.likes_tooltip_name,value:i.name},{type:"textbox",name:"link",label:t.likes_label_link,tooltip:t.likes_tooltip_link,value:i.link},{type:"textbox",name:"post_id",label:t.likes_label_post_id,tooltip:t.likes_tooltip_post_id,value:i.post_id}];case"comments":return[{type:"listbox",name:"style",label:t.likes_label_style,values:[{text:"Simple 1",value:"simple-1"},{text:"Button 1",value:"button-1"},{text:"Button 1 Colored",value:"button-1-color"},{text:"Button 2",value:"button-2"},{text:"Button 2 Colored",value:"button-2-color"},{text:"Button 3",value:"button-3"},{text:"Button 3 Colored",value:"button-3-color"},{text:"Button 4",value:"button-4"},{text:"Button 5",value:"button-5"},{text:"Color 1",value:"color-1"},{text:"Color 2",value:"color-2"},{text:"Vertical 1",value:"vertical-1"}],value:i.style},{type:"listbox",name:"size",label:t.likes_label_size,values:[{text:"XS",value:"xs"},{text:"S",value:"s"},{text:"M",value:"m"},{text:"L",value:"l"},{text:"XL",value:"xl"},{text:"XXL",value:"xxl"}],value:i.size},{type:"listbox",name:"icons",label:t.likes_label_icons,values:[{text:"thumbs",value:"thumbs"},{text:"chevron",value:"chevron"},{text:"chevron-bold",value:"chevron-bold"},{text:"plusminus",value:"plusminus"},{text:"plusminus-circle",value:"plusminus-circle"},{text:"arrow-1",value:"arrow-1"},{text:"arrow-2",value:"arrow-2"},{text:"arrow-3",value:"arrow-3"},{text:"heart",value:"heart"},{text:"smile",value:"smile"}],value:i.icons},{type:"checkbox",name:"show_icon",label:t.likes_label_show_icon,text:t.likes_text_show,checked:i.show_icon},{type:"checkbox",name:"show_label",label:t.likes_label_show_label,text:t.likes_text_show,checked:i.show_label},{type:"checkbox",name:"show_count",label:t.likes_label_show_count,text:t.likes_text_show,checked:i.show_count},{type:"checkbox",name:"hide_dislikes",label:t.likes_label_hide_dislikes,text:t.likes_text_hide,checked:i.hide_dislikes},{type:"textbox",name:"label_like",label:t.likes_label_like,value:i.label_like},{type:"textbox",name:"label_dislike",label:t.likes_label_dislike,value:i.label_dislike}]}return[]}})),jQuery((function(t){if(expert_review_globals.enabled){var i=expert_review_globals.i18n,r="expert_review_poll",a=new e,n={name:"",title:"",show_title:!1,show_count:!0,show_results_button:!1,style:"simple-1",color:"blue-1",multiple:!1,answers:[]},s=wp.media.template("expert-review-poll-popup");t(".expert-review-loading").remove(),t("body").prepend('<div class="expert-review-loading" style="display: none">Loading&#8230;</div>'),t(document).on("change",".js-mce-expert-review-poll-prepared select",(function(){t(this).val()?t(document).find(".js-mce-expert-review-poll-main-data").hide():t(document).find(".js-mce-expert-review-poll-main-data").show()})),t(document).on("click",".js-mce-expert-review-poll-answers-add",(function(e){e.preventDefault();var i,r=t(this).parent().parent().find(".js-mce-expert-review-poll-answers-list"),a=r.find(".js-mce-expert-review-poll-answers-item").last().clone();return a.find("textarea").val(""),a.find(".js-mce-expert-review-poll-answers-item-id").val((i=1,t(document).find(".js-mce-expert-review-poll-answers-item-id").each((function(){i=Math.max(i,parseInt(t(this).val()))})),i+1)),r.append(a),!1})),t(document).on("click",".js-mce-expert-review-poll-answers-remove",(function(e){e.preventDefault();var i=t(this).parents(".js-mce-expert-review-poll-answers-item");i.parent().find(".js-mce-expert-review-poll-answers-item").length>1?i.remove():(i.find("textarea").val(""),i.find(".js-mce-expert-review-poll-answers-item-id").val("1"))})),wp.mce=wp.mce||{},wp.mce.expert_review_poll={shortcode_data:{},template:wp.media.template("expert-review-poll-live-preview"),getContent:function(){var e=this.shortcode.attrs.named,i=t.extend({},n,a.unserialize(e.params));try{return this.template(i)}catch(e){return console.error(e),"<div>Unable to unserialize params, check console<div>"}},edit:function(e){var t=wp.shortcode.next(r,e).shortcode.attrs.named;try{wp.mce.expert_review_poll.popupwindow(tinyMCE.activeEditor,a.unserialize(t.params),t.id)}catch(e){alert("Unable to unserialize params, check console"),console.error(e)}},popupwindow:function(e,l,o){l=t.extend({},n,l);var p=!1;e.windowManager.open({title:i.poll,html:s(l),width:600,height:t(window).height()-200,buttons:[{text:i.ok,subtype:"primary",onclick:function(){var i=t(document).find(".js-mce-expert-review-poll-prepared select").val();if(i)t.ajax({url:expert_review_globals.url,type:"post",data:{action:"expert_review_get_poll",nonce:expert_review_globals.nonce,id:i,post_id:t("#post_ID").val()},beforeSend:function(){t(".expert-review-loading").show(),p=!0}}).done((function(e){e.success?u(i,e.data.params):console.log(e)})).always((function(){t(".expert-review-loading").hide(),p=!1}));else{var n,s,l=((s={}).color=(n=function(e){var i=t(document).find(e);return i.is(":checkbox")?i.prop("checked")?1:0:i.val()})(".js-mce-expert-review-color-field"),s.title=n(".js-mce-expert-review-poll-title input"),s.show_title=n(".js-mce-expert-review-poll-show-title input"),s.style=n(".js-mce-expert-review-poll-style select"),s.show_count=n(".js-mce-expert-review-poll-show-count input"),s.show_results_button=n(".js-mce-expert-review-poll-show-result-button input"),s.multiple=n(".js-mce-expert-review-poll-multiple input"),s.answers=[],t(document).find(".js-mce-expert-review-poll-answers-item").each((function(){var e=t(this),i=e.find("textarea").val(),r=parseInt(e.find(".js-mce-expert-review-poll-answers-item-id").val());i&&s.answers.push({id:r,text:i})})),s);if(!p){var c={action:"expert_review_save_poll",nonce:expert_review_globals.nonce,params:l,post_id:t("#post_ID").val(),current:o};t.ajax({url:expert_review_globals.url,type:"post",data:c,beforeSend:function(){t(".expert-review-loading").show(),p=!0}}).done((function(e){var i=function(e){if(!e.success&&"object"==typeof e.data)for(var i=0;i<e.data.length;i++)if("object"==typeof e.data[i]){var r=t.extend({code:"",message:""},e.data[i]);if("same_poll_with_new_answers"===r.code)return r.message}return null}(e);if(e.success)u(e.data.post_id,l);else if(i){if(!confirm(i))return;c.confirm_update=1,t.ajax({url:expert_review_globals.url,type:"post",data:c,beforeSend:function(){t(".expert-review-loading").show(),p=!0}}).done((function(e){e.success?u(e.data.post_id,l):console.log(e)})).always((function(){p=!1,t(".expert-review-loading").hide()}))}else console.log(e)})).always((function(){p=!1,t(".expert-review-loading").hide()}))}}function u(t,i){e.insertContent(wp.shortcode.string({tag:r,type:"single",attrs:{id:t,params:a.serialize(i)}})),tinymce.activeEditor.windowManager.close()}}},{text:i.cancel,onclick:"close"}]}),setTimeout((function(){t(document).find('.js-mce-expert-review-color[data-color="'+l.color+'"]').trigger("click"),t(document).find(".mce-expert-review-poll-answers-list").sortable({items:".mce-expert-review-poll-answers-item",axis:"y"})}),50)}},wp.mce.views.register(r,wp.mce.expert_review_poll)}})),jQuery((function(e){if(expert_review_globals.enabled){var t=expert_review_globals.i18n,i=wp.media,r="expert_review_likes_rate";wp.mce=wp.mce||{},wp.mce.expert_review_likes_rate={shortcode_data:{},template:i.template("expert-review-likes-rate-live-preview"),getContent:function(){var e=this.shortcode.attrs.named;return e.innercontent=this.shortcode.content,this.template(e)},edit:function(e){var t=wp.shortcode.next(r,e),i=t.shortcode.attrs.named;i.innercontent=t.shortcode.content,wp.mce.expert_review_likes_rate.popupwindow(tinyMCE.activeEditor,i)},popupwindow:function(i,a,n){a=e.extend({},{title:t.like_rate_title_default,style:"style-1",order:"desc",post_ids:"",include_likes:"",limit:"",output_total_score:!1},a);["output_total_score"].forEach((function(e){a.hasOwnProperty(e)&&"boolean"!=typeof a[e]&&(a[e]=!!parseInt(a[e]))})),"function"!=typeof n&&(n=function(e){var t={tag:r,type:"single",attrs:{title:e.data.title,style:e.data.style,order:e.data.order,post_ids:e.data.post_ids,include_likes:e.data.include_likes,limit:e.data.limit,output_total_score:e.data.output_total_score?1:0}};i.insertContent(wp.shortcode.string(t))}),i.windowManager.open({title:t.like_rate_popup_title,body:[{type:"textbox",name:"title",label:t.like_rate_title,value:a.title},{type:"listbox",name:"style",label:t.like_rate_style,values:[{text:"Style 1",value:"style-1"},{text:"Style 2",value:"style-2"},{text:"Table 1",value:"table-1"},{text:"Simple 1",value:"simple-1"}],value:a.style},{type:"listbox",name:"order",label:t.like_rate_order,values:[{text:t.like_rate_order_asc,value:"asc"},{text:t.like_rate_order_desc,value:"desc"},{text:t.like_rate_order_asc_likes,value:"asc_likes"},{text:t.like_rate_order_desc_likes,value:"desc_likes"},{text:t.like_rate_order_asc_dislikes,value:"asc_dislikes"},{text:t.like_rate_order_desc_dislikes,value:"desc_dislikes"}],value:a.order},{type:"textbox",name:"post_ids",label:t.like_rate_post_ids_title,value:a.post_ids},{type:"textbox",name:"include_likes",label:t.like_rate_include_likes_title,value:a.include_likes},{type:"textbox",name:"limit",label:t.like_rate_limit_title,value:a.limit}],onsubmit:n})}},wp.mce.views.register(r,wp.mce.expert_review_likes_rate)}})),jQuery((function(e){var t=expert_review_globals.i18n;if(e(".js-expert-form-wrapper").length){var i=e(".js-expert-data"),r=e(".js-expert-list"),a=e(".js-add-expert"),n=e(".js-expert-form"),s=e(".js-expert-avatar"),l=e(".js-expert-name"),o=e(".js-expert-email"),p=e(".js-expert-link"),c=e(".js-expert-description"),u=i.val();try{u=u?JSON.parse(u):[]}catch(e){console.error("Error parse items",e)}x();for(var d=0,v=0;v<u.length;v++)d=Math.max(u[v].id,d);a.on("click",(function(e){if(e.preventDefault(),l.val()){var i={id:++d,avatar:s.val(),name:l.val(),email:o.val(),link:p.val(),description:c.val()};u.push(i),x(),n.find("input").val("")}else alert(t.require_name)})),e(document).on("click",".js-expert-remove",(function(t){t.preventDefault();var i=e(this).data("id");u=u.filter((function(e){return parseInt(e.id)!==parseInt(i)})),x()})),e(document).on("click",".js-expert-edit",(function(i){i.preventDefault();var r=e(this);if(!r.data("state_edit")){r.data("state_edit",1);var a=r.data("id"),s=n.clone(),l=s.find(".js-add-expert"),o=e('<a href="#">'+t.cancel+"</a>"),p=u.filter((function(e){return e.id==a}));p.length&&(p=p[0],s.find(".js-expert-avatar").val(p.avatar),s.find(".js-expert-name").val(p.name),s.find(".js-expert-email").val(p.email),s.find(".js-expert-link").val(p.link),s.find(".js-expert-description").val(p.description),l.removeClass("js-add-expert").text(t.save),s.removeClass("js-expert-form"),s.append(o),r.parents(".js-expert-form-item").append(s),o.on("click",(function(e){e.preventDefault(),s.remove(),r.data("state_edit",0)})),l.on("click",(function(e){e.preventDefault(),s.remove(),p.avatar=s.find(".js-expert-avatar").val(),p.name=s.find(".js-expert-name").val(),p.email=s.find(".js-expert-email").val(),p.link=s.find(".js-expert-link").val(),p.description=s.find(".js-expert-description").val(),x(),r.data("state_edit",0)})))}}))}function x(){i.val(u.length?JSON.stringify(u):""),r.empty();for(var e=0;e<u.length;e++){var a="",n=u[e].avatar,s=u[e].name,l=u[e].email||"",o=u[e].link,p=u[e].description;n&&(a+='<div><img src="'+n+'" class="expert-avatar"></div>'),a+="<div>",a+=s,l&&(a+=" &lt;"+l+"&gt;"),o&&(a+=' [<a href="'+o+'" rel="noopener" target="_blank">'+o+"</a>]"),p&&(a+='<p class="description">'+p+"</p>"),a+=' <a href="#" data-id="'+u[e].id+'" class="js-expert-edit">'+t.edit+"</a>",a+=' <a href="#" data-id="'+u[e].id+'" class="js-expert-remove" style="color: red">'+t.remove+"</a>",a+="</div>",r.append('<li class="js-expert-form-item">'+a+"</li>")}}}))}));